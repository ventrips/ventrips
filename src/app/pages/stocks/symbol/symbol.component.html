<!-- Horizontal Display Ad-->
<section class="container-fluid text-center pt-2 mb-5">
    <ng-adsense
        [fullWidthResponsive]="true"
        [display]="'block'"
        [adClient]="'ca-pub-4642980268605791'"
        [adSlot]=2801999023
        [adFormat]="'auto'">
    </ng-adsense>
</section>
<div class="container-fluid my-5">
    <span class="d-flex flex-wrap align-items-center justify-center">
        <nav aria-label="breadcrumb mb-3">
            <ol class="breadcrumb h4 bg-light mr-5 mb-0 p-0">
            <li class="breadcrumb-item">
                <a [routerLink]="['', 'symbol']" class="badge badge-dark text-white text-capitalize py-2 pr-2">Stocks</a>
            </li>
            <li class="breadcrumb-item">
                <a [routerLink]="[]" class="badge badge-warning text-dark text-capitalize py-2 pr-2">{{symbol}}</a>
            </li>
            </ol>
        </nav>
        <p class="text-center small text-dark my-4 ml-sm-auto" *ngIf="!_.isEmpty(lastRefreshed)">
            {{lastRefreshed | date:'fullDate'}} @ {{lastRefreshed | date:'mediumTime'}}
        </p>
    </span>
    <div class="h5 my-5">
        <h1 class="mb-4">{{title}}</h1>
        <p class="my-3">
            {{description}}
        </p>
    </div>
    <section class="mb-3 d-flex flex-wrap align-items-center">
        <span class="h5 my-2 mr-3">Share</span>
        <share-buttons
        [theme]="'default'"
        [include]="['twitter', 'facebook', 'linkedin', 'reddit', 'tumblr', 'copy']"
        [exclude]="[]"
        [showText]="false"
        [showCount]="false"
        url="{{environment.url}}{{url}}">
        </share-buttons>
    </section>
    <div class="my-4 px-2 text-white bg-dark sticky-top" *ngIf="metaData?.symbol">
        <div class="input-group mb-2" *ngIf="authService?.canEdit(user)">
            <div class="input-group-prepend">
                <div ngbDropdown class="d-inline-block">
                    <button class="btn btn-lg btn-warning" id="order-by-dropdown" title="Sort By" ngbDropdownToggle>
                        {{ interval ? interval : 'Interval' }}
                    </button>
                    <div ngbDropdownMenu aria-labelledby="order-by-dropdown">
                        <button class="dropdown-item cursor-pointer" [class.cursor-pointer]="!_.isEqual(option, interval)" [class.active]="_.isEqual(option, interval)"
                        [disabled]="_.isEqual(option, interval)" *ngFor="let option of intervalOptions" (click)="interval = option">
                            {{option}}
                        </button>
                    </div>
                </div>
            </div>
            <input type="text" class="form-control form-control-lg" aria-label="Search for symbol" placeholder="Search for symbol"
                [(ngModel)]="symbol" />
            <div class="input-group-append">
                <button class="btn btn-warning" [disabled]="!symbol" (click)="refreshData()">
                    <ng-container *ngIf="isPlatformBrowser()">
                        <fa-icon [icon]="['fas', 'search']" class="text-dark"></fa-icon>
                    </ng-container>
                </button>
            </div>
        </div>
        <ng-container *ngIf="toggleEdit">
            <div class="row">
                <div class="col-6">
                    <div class="form-group">
                        <label for="lowerBound">Lower Bound (%)</label>
                        <input type="number" id="lowerBound" class="form-control form-control-sm" aria-label="Lower Bound" placeholder="Lower Bound" [(ngModel)]="lowParam"/>
                    </div>
                </div>
                <div class="col-6">
                    <div class="form-group">
                        <label for="upperBound">Upper Bound (%)</label>
                        <input type="number" id="upperBound" class="form-control form-control-sm" aria-label="Upper Bound" placeholder="Upper Bound" [(ngModel)]="highParam"/>
                    </div>
                </div>
            </div>
        </ng-container>
    </div>
    <ng-container *ngIf="authService?.canEdit(user)">
        <p class="text-center small my-5 text-dark" *ngIf="updated">
            Last Updated: {{updated | timeStampDate:'short'}} ({{updated | timeAgo}})
        </p>
    </ng-container>
    <section>
        <ng-container *ngIf="!isLoading && !_.isEmpty(data)">
            <ng-container *ngIf="isPlatformBrowser()">
                <section *ngFor="let item of data; let index = index">
                    <app-dynamic-chart [symbol]="metaData?.symbol" [toggleEdit]="toggleEdit" [date]="item?.date" [data]="item?.data" [metaData]="metaData" [lowParam]="lowParam" [highParam]="highParam"></app-dynamic-chart>
                </section>
            </ng-container>
        </ng-container>
        <ng-container *ngIf="!isLoading && _.isEmpty(data)">
            <div class="my-5 text-center d-flex flex-wrap justify-content-center align-items-center min-height-25vh">
                <div>
                    <h1 class="text-uppercase">Loading...</h1>
                    <p class="text-muted">If nothing shows up after a few seconds, this means that this symbol does not exist. To get this featured, you can <a class="text-warning" [routerLink]="['/contact']">Contact Us</a></p>
                </div>
            </div>
        </ng-container>
    </section>
    <div class="container my-5" *ngIf="environment.production && !_.isEmpty(data)">
        <disqus [identifier]="url" url="{{environment.url}}{{url}}" [title]="title" [category]="'stocks'"></disqus>
    </div>
</div>
<!-- Horizontal Display Ad-->
<section class="container-fluid text-center pt-2 mb-5">
    <ng-adsense
        [fullWidthResponsive]="true"
        [display]="'block'"
        [adClient]="'ca-pub-4642980268605791'"
        [adSlot]=2801999023
        [adFormat]="'auto'">
    </ng-adsense>
</section>
